<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <!-- jQuery library-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="styles.css" />
    <!--Iconos Bootstrap-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
  </head>
  <body class="vh-100 bg-light">
    <div class="container-fluid h-100 d-flex flex-column">
      <!--Header-->
      <nav class="navbar navbar-default mx-2">
        <span class="narbar-brand h2">
          <i class="bi bi-universal-access-circle"></i>
          EVENTPAGE | ADMIN SYSTEM
        </span>
      </nav>
      <!--End of Header-->
      <!--Page Content-->
      <div class="row flex-grow-1 mb-3 flex-column flex-md-row m-auto w-100">
        <!-- Sidebar -->
        <div class="bg-white col-12 col-lg-2 p-2 shadow rounded-3">
          <ul
            class="nav nav-pills flex-row flex-lg-column m-auto h-100 justify-content-center"
          >
            <li class="nav-item d-none d-lg-inline">
              <a href="#" class="nav-link">
                <i class="bi bi-arrow-bar-left"></i>
                <span class="d-none d-md-inline">Ocultar</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="dashboard.html" class="nav-link" area-current="page">
                <i class="bi bi-bar-chart-fill"></i>
                <span class="d-none d-md-inline">Dashboard</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link active">
                <i class="bi bi-calendar-event"></i>
                <span class="d-none d-md-inline">Eventos</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="bi bi-tag"></i>
                <span class="d-none d-md-inline">Categoria Eventos</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="bi bi-person-workspace"></i>
                <span class="d-none d-md-inline">Invitados</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="bi bi-person-fill-lock"></i>
                <span class="d-none d-md-inline">Administradores</span>
              </a>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="bi bi-people-fill"></i>
                <span class="d-none d-md-inline">Usuarios</span>
              </a>
            </li>
            <li class="nav-item mt-0 mt-lg-auto">
              <a href="#" class="nav-link">
                <i class="bi bi-box-arrow-left"></i>
                <span class="d-none d-md-inline">Salir</span>
              </a>
            </li>
          </ul>
        </div>
        <!-- End of Sidebar -->
        <!-- Main Content -->
        <div class="col">
          <div class="row mx-auto py-3 py-lg-0">
            <div class="col-12">
              <h2 style="font-weight: 100">Eventos</h2>
            </div>
            <div class="col-12">
              <div class="card bg-light border-0">
                <div
                  class="table-responsive"
                  style="max-height: 70vh; min-height: 70vh"
                >
                  <table class="table table-none">
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">Titulo</th>
                        <th scope="col">Fecha</th>
                        <th scope="col">Categoría</th>
                        <th scope="col">Capacidad</th>
                        <th scope="col">Costo</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr data-id="1">
                        <td>1</td>
                        <td>Evento 1</td>
                        <td>2022-01-01 12:00</td>
                        <td>Conferencia</td>
                        <td>100</td>
                        <td>$10.00</td>
                      </tr>
                      <tr data-id="2">
                        <td>2</td>
                        <td>Evento 2</td>
                        <td>2022-02-02 14:00</td>
                        <td>Taller</td>
                        <td>50</td>
                        <td>$20.00</td>
                      </tr>
                      <tr data-id="3">
                        <td>3</td>
                        <td>Evento 3</td>
                        <td>2022-03-03 16:00</td>
                        <td>Workshop</td>
                        <td>20</td>
                        <td>$30.00</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            <div class="col d-flex justify-content-end gap-1 my-2">
              <button
                type="button"
                class="btn btn-outline-secondary"
                id="deleteButton"
                disabled
              >
                Eliminar
              </button>
              <button
                type="button"
                class="btn btn-outline-secondary"
                id="editButton"
                disabled
              >
                Editar
              </button>
              <button
                type="button"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#addEventModal"
                data-bs-whatever="@getbootstrap"
                id="addButton"
              >
                Agregar
              </button>
            </div>
          </div>
        </div>
      </div>
      <!--End of Page Content-->
      <!--Add event modal-->
      <div
        class="modal fade"
        id="addEventModal"
        tabindex="-1"
        aria-labelledby="exampleModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="exampleModalLabel">
                Agregar Evento
              </h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <!--Esto es el formulario que se usa tanto para añadir eventos o editarlos-->
              <form id="addEventForm" method="POST">
                <div class="mb-3">
                  <label for="event-name" class="col-form-label"
                    >Título de evento:</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="event-name"
                    maxlength="45"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label for="event-description" class="col-form-label"
                    >Descripción:</label
                  >
                  <textarea
                    class="form-control"
                    id="event-description"
                    required
                  ></textarea>
                </div>
                <div class="mb-3">
                  <label for="event-date" class="col-form-label"
                    >Fecha de evento:</label
                  >
                  <input
                    type="datetime-local"
                    class="form-control"
                    id="event-date"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label for="event-price" class="col-form-label"
                    >Costo de entrada:</label
                  >
                  <div class="input-group">
                    <span class="input-group-text">$</span>
                    <input
                      type="number"
                      class="form-control"
                      id="event-price"
                      min="0"
                      required
                    />
                    <span class="input-group-text">.00</span>
                  </div>
                </div>
                <div class="mb-3">
                  <label for="event-label" class="col-form-label"
                    >Categoría de evento:</label
                  >
                  <select
                    id="event-label"
                    class="form-select"
                    aria-label="Default select example"
                    required
                  >
                    <option value="" selected>
                      Selecciona una categoría de evento
                    </option>
                    <option value="conferencia">Conferencia</option>
                    <option value="taller">Taller</option>
                    <option value="workshop">Workshop</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label for="event-capacity" class="col-form-label"
                    >Capacidad de evento:</label
                  >
                  <input
                    type="number"
                    class="form-control"
                    id="event-capacity"
                    min="0"
                    required
                  />
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cancelar
              </button>
              <button type="submit" class="btn btn-primary" form="addEventForm">
                Guardar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      $(document).ready(function () {
        // Funcion que agrega la clase table-active a la fila seleccionada
        $("tbody tr").click(function () {
          // Deselect all rows
          $("tbody tr").removeClass("table-active");
          // Select clicked row
          $(this).addClass("table-active");
          // Enable edit button
          $("#editButton").prop("disabled", false);
          // Set data in modal
        });
        // Funcion que permite editar los datos de la fila seleccionada
        $("#editButton").click(function () {
          // Get selected row data
          var selectedRow = $("tr.table-active");
          var id = selectedRow.attr("data-id");
          var title = selectedRow.find("td:nth-child(2)").text();
          var date = selectedRow.find("td:nth-child(3)").text();
          var category = selectedRow
            .find("td:nth-child(4)")
            .text()
            .toLowerCase();
          var capacity = selectedRow.find("td:nth-child(5)").text();
          var price = selectedRow.find("td:nth-child(6)").text();
          // Load data into modal
          $("#event-name").val(title);
          $("#event-date").val(date);
          $("#event-label").val(category);
          $("#event-capacity").val(capacity);
          $("#event-price").val(price.replace("$", "").replace(".00", ""));
          // Change modal title
          $("#addEventModal .modal-title").text("Editar evento");
          // Show modal
          $("#addEventModal").modal("show");
        });

        // Funcion que permite eliminar los datos de la fila seleccionada (no funciona)
        $("#deleteButton").click(function () {
          // Get selected row data
          var id = $("#addEventModal").data("id");
          // Remove table row
          $('tr[data-id="' + id + '"]').remove();
          // Deselect row
          $("tbody tr").removeClass("table-active");
          // Disable edit button
          $("#editButton").prop("disabled", true);
          // Clear modal data
          $("#event-name").val("");
          $("#event-date").val("");
          $("#event-label").val("");
          $("#event-capacity").val("");
          $("#event-price").val("");
          $("#addEventModal").removeData("id");
          // Hide modal
          $("#addEventModal").modal("hide");
        });

        // Funcion que deshabilita el boton de editar cuando se cambia algun valor en el formulario
        $(
          "#event-name, #event-date, #event-label, #event-capacity, #event-price"
        ).change(function () {
          // Disable edit button
          $("#editButton").prop("disabled", true);
        });

        // Funcion que permite limpia el formulario cuando se abre el formulario
        $("#addButton").click(function () {
          // Clear modal data
          $("#event-name").val("");
          $("#event-date").val("");
          $("#event-label").val("");
          $("#event-capacity").val("");
          $("#event-price").val("");
          $("#addEventModal").removeData("id");
          // Change modal title
          $("#addEventModal .modal-title").text("Agregar evento");
        });
      });
    </script>
  </body>
</html>
